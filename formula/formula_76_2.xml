<formula type="76" name="Separated Perpendicular" power="2" glitch="1e-6">
  <reference t="R">
    Xrn = Xr2 - Xi2 - 7/2 * abs(Xr) + Cr;
    Xin = 2 * Xi * (7/4 - abs(Xr)) + Ci;
  </reference>
  <references t="R" name="X1" update="X1n" value="0">
    X1n = 7/4 - abs(Xrn);
  </references>
  <perturbation t="R">
    xrn = (2 * Xr + xr) * xr - (2 * Xi + xi) * xi - 7/2 * diffabs(Xr, xr) + cr;
    xin = 2 * xi * X1 - 2 * Xxi * diffabs(Xr, xr) + ci;
<!--
    xin = 2 * xi * diffabs(7/4, X1 + xr) - 2 * Xi * diffabs(Xr, xr) + ci;

    xin = 2 * (1.75 - abs(Xxr)) * xi - 2 * Xi * diffabs(Xr, xr) + ci
        = 2 * (abs(1.75) - abs(1.75 + (Xxr - 1.75))) * xi - 2 * Xi * diffabs(Xr, xr) + ci
        = 2 * (diffabs(1.75, Xxr - 1.75) * xi - 2 * Xi * diffabs(Xr, xr) + ci
        = 2 * diffabs(1.75, (Xr - 1.75) + xr) * xi - 2 * Xi * diffabs(Xr, xr) + ci
-->
  </perturbation>
  <derivative t="R">
<!-- /* todo */ -->
  </derivative>
  <glitch t="R" factorhi="2" factorlo="1">
    <test>
      <lhs>factor * abs(X1 - diffabs(Xr, xr))</lhs>
      <rhs>abs(X1)</rhs>
      <cond>lhs &lt; rhs</cond>
      <size>lhs / rhs</size>
    </test>
    <test>
      <lhs>factor * abs((2 * Xr + xr) - T(7.0/2.0))</lhs>
      <rhs>T(7.0/2.0)</rhs>
      <cond>lhs &lt; rhs</cond>
      <size>lhs / rhs</size>
    </test>
<!--
    <test>
      <lhs>factor * abs(X1 + xr)</lhs>
      <rhs>abs(X1)</rhs>
      <cond>lhs &lt; rhs</cond>
      <size>lhs / rhs</size>
    </test>
-->
  </glitch>
</formula>
