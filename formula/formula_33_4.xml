<formula type="33" name="SimonBrot 4th" power="4" glitch="0.000001">
  <reference t="R">
    Xrn = Xi2 * abs(Xi2) - 4 * Xi * abs(Xr * Xi) * Xr - Xr2 * abs(Xi2) - Xi2 * abs(Xr2) + Xr2 * abs(Xr2) + Cr;
    Xin = Ci - 2 * Xr * Xi * abs(Xi2) - 2 * Xi2 * abs(Xr * Xi) + 2 * Xr2 * abs(Xr * Xi) + 2 * Xr * Xi * abs(Xr2);
  </reference>
  <perturbation t="R">
    xrn = (Xi2) * diffabs(Xi2,2 * xi * Xi + xi2) - 4 * Xi * Xr * diffabs(Xr * Xi,Xr * xi + xr * Xi + xr * xi) - Xr2 * diffabs(Xi2,2 * xi * Xi + xi2) - Xi2 * diffabs(Xr2,2 * Xr * xr + xr2) + Xr2 * diffabs(Xr2,2 * Xr * xr + xr2) + (2 * xi * Xi + xi2) * abs(Xi2 + 2 * xi * Xi + xi2) - 4 * (Xi * xr + xi * Xr + xi * xr) * abs(Xr * Xi + Xr * xi + xr * Xi + xr * xi) - (2 * Xr * xr + xr2) * abs(Xi2 + 2 * xi * Xi + xi2) - (2 * xi * Xi + xi2) * abs(Xr2 + 2 * Xr * xr + xr2) + (2 * Xr * xr + xr2) * abs(Xr2 + 2 * Xr * xr + xr2) + cr;
    xin = 2 * Xr2 * diffabs(Xr * Xi,Xr * xi + xr * Xi + xr * xi) + 2 * Xr * Xi * diffabs(Xr2,2 * Xr * xr + xr2) - 2 * Xr * Xi * diffabs(Xi2,2 * xi * Xi + xi2) - 2 * Xi2 * diffabs(Xr * Xi,Xr * xi + xr * Xi + xr * xi) + 2 * (2 * Xr * xr + xr2) * abs(Xr * Xi + Xr * xi + xr * Xi + xr * xi)  + 2 * (Xr * xi + xr * Xi + xr * xi) * abs(Xr2 + 2 * Xr * xr + xr2) - 2 * (Xr * xi + xr * Xi + xr * xi) * abs(Xi2 + 2 * xi * Xi + xi2) - 2 * (2 * xi * Xi + xi2) * abs(Xr * Xi + Xr * xi + xr * Xi + xr * xi)  + ci;
  </perturbation>
  <derivative t='M'>
    dxan = ((2 * (abs((Xxr * Xxr)) * (Xxr * dxa))) + (( - 2 * (abs((Xxi * Xxi)) * (Xxr * dxa))) + ((2 * (sgn(Xxr) * (Xxr * (Xxr * (Xxr * (dxa * sgn(Xxr))))))) + (( - 2 * (abs((Xxr * Xxr)) * (Xxi * dya))) + ((2 * (abs((Xxi * Xxi)) * (Xxi * dya))) + (( - 2 * (sgn(Xxi) * (Xxi * (Xxr * (Xxr * (dya * sgn(Xxi))))))) + (( - 2 * (sgn(Xxr) * (Xxi * (Xxi * (Xxr * (dxa * sgn(Xxr))))))) + ((2 * (sgn(Xxi) * (Xxi * (Xxi * (Xxi * (dya * sgn(Xxi))))))) + (( - 4 * (abs((Xxi * Xxr)) * (Xxi * dxa))) + (( - 4 * (abs((Xxi * Xxr)) * (Xxr * dya))) + (( - 4 * (sgn(Xxi) * (Xxi * (Xxi * (Xxr * (dxa * sgn(Xxr))))))) + (( - 4 * (sgn(Xxi) * (Xxi * (Xxr * (Xxr * (dya * sgn(Xxr))))))) + daa))))))))))));
    dxbn = ((2 * (abs((Xxr * Xxr)) * (Xxr * dxb))) + (( - 2 * (abs((Xxi * Xxi)) * (Xxr * dxb))) + ((2 * (sgn(Xxr) * (Xxr * (Xxr * (Xxr * (dxb * sgn(Xxr))))))) + (( - 2 * (abs((Xxr * Xxr)) * (Xxi * dyb))) + ((2 * (abs((Xxi * Xxi)) * (Xxi * dyb))) + (( - 2 * (sgn(Xxi) * (Xxi * (Xxr * (Xxr * (dyb * sgn(Xxi))))))) + (( - 2 * (sgn(Xxr) * (Xxi * (Xxi * (Xxr * (dxb * sgn(Xxr))))))) + ((2 * (sgn(Xxi) * (Xxi * (Xxi * (Xxi * (dyb * sgn(Xxi))))))) + (( - 4 * (abs((Xxi * Xxr)) * (Xxi * dxb))) + (( - 4 * (abs((Xxi * Xxr)) * (Xxr * dyb))) + (( - 4 * (sgn(Xxi) * (Xxi * (Xxi * (Xxr * (dxb * sgn(Xxr))))))) + (( - 4 * (sgn(Xxi) * (Xxi * (Xxr * (Xxr * (dyb * sgn(Xxr))))))) + dab))))))))))));
    dyan = ((2 * (abs((Xxr * Xxr)) * (Xxr * dya))) + (( - 2 * (abs((Xxi * Xxi)) * (Xxr * dya))) + ((2 * (abs((Xxr * Xxr)) * (Xxi * dxa))) + ((2 * (sgn(Xxi) * (Xxr * (Xxr * (Xxr * (dya * sgn(Xxr))))))) + (( - 2 * (abs((Xxi * Xxi)) * (Xxi * dxa))) + (( - 2 * (sgn(Xxi) * (Xxi * (Xxi * (Xxi * (dxa * sgn(Xxr))))))) + (( - 2 * (sgn(Xxi) * (Xxi * (Xxi * (Xxr * (dya * sgn(Xxr))))))) + ((2 * (sgn(Xxi) * (Xxi * (Xxr * (Xxr * (dxa * sgn(Xxr))))))) + ((4 * (abs((Xxi * Xxr)) * (Xxr * dxa))) + (( - 4 * (abs((Xxi * Xxr)) * (Xxi * dya))) + ((4 * (sgn(Xxr) * (Xxi * (Xxr * (Xxr * (dxa * sgn(Xxr))))))) + (( - 4 * (sgn(Xxi) * (Xxi * (Xxi * (Xxr * (dya * sgn(Xxi))))))) + dba))))))))))));
    dybn = ((2 * (abs((Xxr * Xxr)) * (Xxr * dyb))) + (( - 2 * (abs((Xxi * Xxi)) * (Xxr * dyb))) + ((2 * (abs((Xxr * Xxr)) * (Xxi * dxb))) + ((2 * (sgn(Xxi) * (Xxr * (Xxr * (Xxr * (dyb * sgn(Xxr))))))) + (( - 2 * (abs((Xxi * Xxi)) * (Xxi * dxb))) + (( - 2 * (sgn(Xxi) * (Xxi * (Xxi * (Xxi * (dxb * sgn(Xxr))))))) + (( - 2 * (sgn(Xxi) * (Xxi * (Xxi * (Xxr * (dyb * sgn(Xxr))))))) + ((2 * (sgn(Xxi) * (Xxi * (Xxr * (Xxr * (dxb * sgn(Xxr))))))) + ((4 * (abs((Xxi * Xxr)) * (Xxr * dxb))) + (( - 4 * (abs((Xxi * Xxr)) * (Xxi * dyb))) + ((4 * (sgn(Xxr) * (Xxi * (Xxr * (Xxr * (dxb * sgn(Xxr))))))) + (( - 4 * (sgn(Xxi) * (Xxi * (Xxi * (Xxr * (dyb * sgn(Xxi))))))) + dbb))))))))))));
  </derivative>
</formula>
