<formula type="51" name="SimonBrot2 4th" power="4" glitch="0.0001">
  <reference t="R">
    Xrn = (Xr2 - Xi2) * abs(Xr2 - Xi2) - 2 * Xr * Xi * abs(2 * Xr * Xi) + Cr;
    Xin = (Xr2 - Xi2) * abs(2 * Xr * Xi) + 2 * Xr * Xi * abs(Xr2 - Xi2) + Ci;
  </reference>
  <perturbation t="R">
    xrn = (Xr2 - Xi2) * diffabs(Xr2 - Xi2,2 * Xr * xr + xr2 - 2 * Xi * xi - xi2) + (2 * Xr * xr + xr2 - 2 * Xi * xi - xi2) * abs(Xr2 + 2 * Xr * xr + xr2 - Xi2 - 2 * Xi * xi - xi2)   - (2 * Xr * Xi) * diffabs(2 * Xr * Xi,2 * Xr * xi + 2 * xr * Xi + 2 * xr * xi) - (2 * Xr * xi + 2 * xr * Xi + 2 * xr * xi) * abs(2 * Xr * Xi + 2 * Xr * xi + 2 * xr * Xi + 2 * xr * xi)   + cr;
    xin = (Xr2 - Xi2) * diffabs(2 * Xr * Xi,2 * Xr * xi + 2 * xr * Xi + 2 * xr * xi) + (2 * Xr * xr + xr2 - 2 * Xi * xi - xi2) * abs(2 * Xr * Xi + 2 * Xr * xi + 2 * xr * Xi + 2 * xr * xi)   + (2 * Xr * Xi) * diffabs(Xr2 - Xi2,2 * Xr * xr + xr2 - 2 * Xi * xi - xi2) + (2 * Xr * xi + 2 * xr * Xi + 2 * xr * xi) * abs(Xr2 - Xi2 + 2 * Xr * xr + xr2 - 2 * Xi * xi - xi2)   + ci;
  </perturbation>
  <derivative t='M'>
    dxan = ((2 * (Xxr * (Xxr * (Xxr * (dxa * sgn((( - 1 * (Xxi * Xxi)) + (Xxr * Xxr)))))))) + ((2 * (abs((( - 1 * (Xxi * Xxi)) + (Xxr * Xxr))) * (Xxr * dxa))) + (( - 2 * (Xxi * (Xxi * (Xxr * (dxa * sgn((( - 1 * (Xxi * Xxi)) + (Xxr * Xxr)))))))) + (( - 2 * (Xxi * (Xxr * (Xxr * (dya * sgn((( - 1 * (Xxi * Xxi)) + (Xxr * Xxr)))))))) + (( - 2 * (abs((( - 1 * (Xxi * Xxi)) + (Xxr * Xxr))) * (Xxi * dya))) + ((2 * (Xxi * (Xxi * (Xxi * (dya * sgn((( - 1 * (Xxi * Xxi)) + (Xxr * Xxr)))))))) + (( - 4 * (abs((Xxi * Xxr)) * (Xxi * dxa))) + (( - 4 * (abs((Xxi * Xxr)) * (Xxr * dya))) + (( - 4 * (sgn(Xxi) * (Xxi * (Xxi * (Xxr * (dxa * sgn(Xxr))))))) + (( - 4 * (sgn(Xxi) * (Xxi * (Xxr * (Xxr * (dya * sgn(Xxr))))))) + daa))))))))));
    dxbn = ((2 * (Xxr * (Xxr * (Xxr * (dxb * sgn((( - 1 * (Xxi * Xxi)) + (Xxr * Xxr)))))))) + ((2 * (abs((( - 1 * (Xxi * Xxi)) + (Xxr * Xxr))) * (Xxr * dxb))) + (( - 2 * (Xxi * (Xxi * (Xxr * (dxb * sgn((( - 1 * (Xxi * Xxi)) + (Xxr * Xxr)))))))) + (( - 2 * (Xxi * (Xxr * (Xxr * (dyb * sgn((( - 1 * (Xxi * Xxi)) + (Xxr * Xxr)))))))) + (( - 2 * (abs((( - 1 * (Xxi * Xxi)) + (Xxr * Xxr))) * (Xxi * dyb))) + ((2 * (Xxi * (Xxi * (Xxi * (dyb * sgn((( - 1 * (Xxi * Xxi)) + (Xxr * Xxr)))))))) + (( - 4 * (abs((Xxi * Xxr)) * (Xxi * dxb))) + (( - 4 * (abs((Xxi * Xxr)) * (Xxr * dyb))) + (( - 4 * (sgn(Xxi) * (Xxi * (Xxi * (Xxr * (dxb * sgn(Xxr))))))) + (( - 4 * (sgn(Xxi) * (Xxi * (Xxr * (Xxr * (dyb * sgn(Xxr))))))) + dab))))))))));
    dyan = ((2 * (abs((( - 1 * (Xxi * Xxi)) + (Xxr * Xxr))) * (Xxi * dxa))) + ((2 * (abs((( - 1 * (Xxi * Xxi)) + (Xxr * Xxr))) * (Xxr * dya))) + ((2 * (sgn(Xxi) * (Xxi * (Xxr * (Xxr * (dxa * sgn(Xxr))))))) + ((2 * (sgn(Xxi) * (Xxr * (Xxr * (Xxr * (dya * sgn(Xxr))))))) + (( - 2 * (sgn(Xxi) * (Xxi * (Xxi * (Xxi * (dxa * sgn(Xxr))))))) + (( - 2 * (sgn(Xxi) * (Xxi * (Xxi * (Xxr * (dya * sgn(Xxr))))))) + ((4 * (abs((Xxi * Xxr)) * (Xxr * dxa))) + (( - 4 * (abs((Xxi * Xxr)) * (Xxi * dya))) + ((4 * (Xxi * (Xxr * (Xxr * (dxa * sgn((( - 1 * (Xxi * Xxi)) + (Xxr * Xxr)))))))) + (( - 4 * (Xxi * (Xxi * (Xxr * (dya * sgn((( - 1 * (Xxi * Xxi)) + (Xxr * Xxr)))))))) + dba))))))))));
    dybn = ((2 * (abs((( - 1 * (Xxi * Xxi)) + (Xxr * Xxr))) * (Xxi * dxb))) + ((2 * (abs((( - 1 * (Xxi * Xxi)) + (Xxr * Xxr))) * (Xxr * dyb))) + ((2 * (sgn(Xxi) * (Xxi * (Xxr * (Xxr * (dxb * sgn(Xxr))))))) + ((2 * (sgn(Xxi) * (Xxr * (Xxr * (Xxr * (dyb * sgn(Xxr))))))) + (( - 2 * (sgn(Xxi) * (Xxi * (Xxi * (Xxi * (dxb * sgn(Xxr))))))) + (( - 2 * (sgn(Xxi) * (Xxi * (Xxi * (Xxr * (dyb * sgn(Xxr))))))) + ((4 * (abs((Xxi * Xxr)) * (Xxr * dxb))) + (( - 4 * (abs((Xxi * Xxr)) * (Xxi * dyb))) + ((4 * (Xxi * (Xxr * (Xxr * (dxb * sgn((( - 1 * (Xxi * Xxi)) + (Xxr * Xxr)))))))) + (( - 4 * (Xxi * (Xxi * (Xxr * (dyb * sgn((( - 1 * (Xxi * Xxi)) + (Xxr * Xxr)))))))) + dbb))))))))));
  </derivative>
</formula>
