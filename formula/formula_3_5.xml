<formula type="3" name="Celtic" power="5" glitch="0.0001">
  <reference t="R">
    Xrn = abs(Xr * (Xr2 * Xr2 - 10 * Xr2 * Xi2 + 5 * Xi2 * Xi2))  + Cr;
    Xin = Xi * (5 * Xr2 * Xr2 - 10 * Xr2 * Xi2 + Xi2 * Xi2)  + Ci;
  </reference>
  <perturbation t="R">
    xrn = diffabs(Xr2 * Xr2 * Xr - 10 * Xr2 * Xr * Xi2 + 5 * Xr * Xi2 * Xi2, 20 * Xr * xi * Xi2 * Xi - 30 * Xr2 * xr * Xi2 + 30 * Xr * xi2 * Xi2 - 30 * Xr * xr2 * Xi2 - 20 * Xr2 * Xr * xi * Xi - 60 * Xr2 * xr * xi * Xi + 20 * Xr * xi2 * xi * Xi - 60 * Xr * xr2 * xi * Xi + 5 * Xr2 * Xr2 * xr - 10 * Xr2 * Xr * xi2 + 10 * Xr2 * Xr * xr2 - 30 * Xr2 * xr * xi2 + 10 * Xr2 * xr2 * xr + 5 * Xr * xi2 * xi2 - 30 * Xr * xr2 * xi2 + 5 * Xr * xr2 * xr2 + 5 * xr * Xi2 * Xi2 + 20 * xr * xi * Xi2 * Xi + 30 * xr * xi2 * Xi2 - 10 * xr2 * xr * Xi2 + 20 * xr * xi2 * xi * Xi - 20 * xr2 * xr * xi * Xi + 5 * xr * xi2 * xi2 - 10 * xr2 * xr * xi2 + xr2 * xr2 * xr) + cr;
    xin = 20 * Xi * Xr2 * Xr * xr + 30 * Xi * Xr2 * xr2 + 20 * Xi * Xr * xr2 * xr + 5 * Xi * xr2 * xr2 - 30 * Xi2 * Xr2 * xi - 30 * Xi * Xr2 * xi2 - 20 * Xi2 * Xi * Xr * xr - 60 * Xi2 * Xr * xr * xi - 60 * Xi * Xr * xr * xi2 - 10 * Xi2 * Xi * xr2 - 30 * Xi2 * xr2 * xi - 30 * Xi * xr2 * xi2 + 5 * Xi2 * Xi2 * xi + 10 * Xi2 * Xi * xi2 + 10 * Xi2 * xi2 * xi + 5 * Xi * xi2 * xi2 + 5 * xi * Xr2 * Xr2 + 20 * xi * Xr2 * Xr * xr + 30 * xi * Xr2 * xr2 + 20 * xi * Xr * xr2 * xr + 5 * xi * xr2 * xr2 - 10 * xi2 * xi * Xr2 - 20 * xi2 * xi * Xr * xr - 10 * xi2 * xi * xr2 + xi2 * xi2 * xi + ci;
  </perturbation>
  <derivative t='M'>
    dxan = ((5 * (Xxi * (Xxi * (Xxi * (Xxi * (dxa * sgn(((5 * (Xxi * (Xxi * (Xxi * (Xxi * Xxr))))) + (( - 10 * (Xxi * (Xxi * (Xxr * (Xxr * Xxr))))) + (Xxr * (Xxr * (Xxr * (Xxr * Xxr))))))))))))) + ((5 * (Xxr * (Xxr * (Xxr * (Xxr * (dxa * sgn(((5 * (Xxi * (Xxi * (Xxi * (Xxi * Xxr))))) + (( - 10 * (Xxi * (Xxi * (Xxr * (Xxr * Xxr))))) + (Xxr * (Xxr * (Xxr * (Xxr * Xxr))))))))))))) + (( - 20 * (Xxi * (Xxr * (Xxr * (Xxr * (dya * sgn(((5 * (Xxi * (Xxi * (Xxi * (Xxi * Xxr))))) + (( - 10 * (Xxi * (Xxi * (Xxr * (Xxr * Xxr))))) + (Xxr * (Xxr * (Xxr * (Xxr * Xxr))))))))))))) + ((20 * (Xxi * (Xxi * (Xxi * (Xxr * (dya * sgn(((5 * (Xxi * (Xxi * (Xxi * (Xxi * Xxr))))) + (( - 10 * (Xxi * (Xxi * (Xxr * (Xxr * Xxr))))) + (Xxr * (Xxr * (Xxr * (Xxr * Xxr))))))))))))) + (( - 30 * (Xxi * (Xxi * (Xxr * (Xxr * (dxa * sgn(((5 * (Xxi * (Xxi * (Xxi * (Xxi * Xxr))))) + (( - 10 * (Xxi * (Xxi * (Xxr * (Xxr * Xxr))))) + (Xxr * (Xxr * (Xxr * (Xxr * Xxr))))))))))))) + daa)))));
    dxbn = ((5 * (Xxi * (Xxi * (Xxi * (Xxi * (dxb * sgn(((5 * (Xxi * (Xxi * (Xxi * (Xxi * Xxr))))) + (( - 10 * (Xxi * (Xxi * (Xxr * (Xxr * Xxr))))) + (Xxr * (Xxr * (Xxr * (Xxr * Xxr))))))))))))) + ((5 * (Xxr * (Xxr * (Xxr * (Xxr * (dxb * sgn(((5 * (Xxi * (Xxi * (Xxi * (Xxi * Xxr))))) + (( - 10 * (Xxi * (Xxi * (Xxr * (Xxr * Xxr))))) + (Xxr * (Xxr * (Xxr * (Xxr * Xxr))))))))))))) + (( - 20 * (Xxi * (Xxr * (Xxr * (Xxr * (dyb * sgn(((5 * (Xxi * (Xxi * (Xxi * (Xxi * Xxr))))) + (( - 10 * (Xxi * (Xxi * (Xxr * (Xxr * Xxr))))) + (Xxr * (Xxr * (Xxr * (Xxr * Xxr))))))))))))) + ((20 * (Xxi * (Xxi * (Xxi * (Xxr * (dyb * sgn(((5 * (Xxi * (Xxi * (Xxi * (Xxi * Xxr))))) + (( - 10 * (Xxi * (Xxi * (Xxr * (Xxr * Xxr))))) + (Xxr * (Xxr * (Xxr * (Xxr * Xxr))))))))))))) + (( - 30 * (Xxi * (Xxi * (Xxr * (Xxr * (dxb * sgn(((5 * (Xxi * (Xxi * (Xxi * (Xxi * Xxr))))) + (( - 10 * (Xxi * (Xxi * (Xxr * (Xxr * Xxr))))) + (Xxr * (Xxr * (Xxr * (Xxr * Xxr))))))))))))) + dab)))));
    dyan = ((5 * (Xxi * (Xxi * (Xxi * (Xxi * dya))))) + ((5 * (Xxr * (Xxr * (Xxr * (Xxr * dya))))) + ((20 * (Xxi * (Xxr * (Xxr * (Xxr * dxa))))) + (( - 20 * (Xxi * (Xxi * (Xxi * (Xxr * dxa))))) + (( - 30 * (Xxi * (Xxi * (Xxr * (Xxr * dya))))) + dba)))));
    dybn = ((5 * (Xxi * (Xxi * (Xxi * (Xxi * dyb))))) + ((5 * (Xxr * (Xxr * (Xxr * (Xxr * dyb))))) + ((20 * (Xxi * (Xxr * (Xxr * (Xxr * dxb))))) + (( - 20 * (Xxi * (Xxi * (Xxi * (Xxr * dxb))))) + (( - 30 * (Xxi * (Xxi * (Xxr * (Xxr * dyb))))) + dbb)))));
  </derivative>
</formula>
